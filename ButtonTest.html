<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ButtonTest</title>
    <style>
        body {
            border: 3px solid black;
            border-radius: 10px;
            width: 800px;
            height: 600px;
            padding: 20px;
            margin: auto;
            margin-top: 100px;
        }

        #TopBlock {
            display: block;
            text-align: center;
            width: 800px;
            height: 50px;
            background-color: yellow;
        }

        #information>div {
            font-size: 15px;
            line-height: 50px;
        }

        #MusicplayerVolume {
            margin-left: 70%;
        }

        #MusicplayerVolume>button {
            width: 25px;
            height: 20px;
            border-width: 1px;
            text-align: center;
            cursor: pointer;
        }

        :root {
            --vol-thumb-width: 12px;
            --vol-thumb-height: 12px;
            --vol-thumb-appearance: none;
            --vol-thumb-border-radius: 50%;
            --vol-thumb-background-color: rgba(0, 0, 0, 0.9);

            --progress-appearance: none;
            --progress-width: 5px;
            --progress-height: 5px;
            --progress-background-color: #E53A40;
            --progress-border-radius: 50%;
            --progress-transition: 0.5s;
            --progress-hover-width: 15px;
            --progress-hover-height: 15px;
        }

        #MusicplayerVolume>input[type="range"] {
            width: 110px;
            height: 7px;
            appearance: none;
            border: 1px solid black;
            border-radius: 30px;
            background: linear-gradient(to right, rgb(255, 179, 14) 50%, rgb(240, 240, 240) 50%);
            transition: background-image 0.3s ease;
        }

        #MusicplayerVolume>input[type="range"]::-webkit-slider-thumb {
            width: var(--vol-thumb-width);
            height: var(--vol-thumb-height);
            appearance: var(--vol-thumb-appearance);
            border-radius: var(--vol-thumb-border-radius);
            background-color: var(--vol-thumb-background-color);
        }

        #volumeControl>input[type="range"]::-moz-range-thumb {
            width: var(--vol-thumb-width);
            height: var(--vol-thumb-height);
            appearance: var(--vol-thumb-appearance);
            border-radius: var(--vol-thumb-border-radius);
            background-color: var(--vol-thumb-background-color);
        }

        #MusicplayerVolume>input[type="text"] {
            width: 30px;
            height: 20px;
            border: 2px solid black;
            color: black;
            text-align: center;
            margin-left: 10px;
        }

        #MusicplayerControls {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: aliceblue;
            border-radius: 50px;
            gap: 30px;
            margin-top: 10px;
            padding: 10px 10px;
        }

        #MusicplayerControls span {
            font-size: 25px;
            font-family: webdings;
            padding: 10px 10px;
            border: solid 1px black;
            cursor: pointer;
            border-radius: 50px;
        }

        #ProgressBar {
            width: 110px;
            height: 7px;
            appearance: none;
            border-radius: 30px;
            background: linear-gradient(to right, rgb(255, 179, 14) 50%, rgb(240, 240, 240) 50%);
        }

        #ProgressBar::-webkit-slider-thumb {
            appearance: var(--progress-appearance);
            background-color: var(--progress-background-color);
            width: var(--progress-width);
            height: var(--progress-height);
        }

        #ProgressBar::-webkit-slider-thumb:hover {
            border-radius: var(--progress-border-radius);
            transition: var(--progress-transition);
            width: var(--progress-hover-width);
            height: var(--progress-hover-height);
        }

        #ProgressBar::-moz-range-thumb {
            appearance: var(--progress-appearance);
            background-color: var(--progress-background-color);
            width: var(--progress-width);
            height: var(--progress-height);
        }

        #ProgressBar::-moz-range-thumb:hover {
            border-radius: var(--progress-border-radius);
            transition: var(--progress-transition);
            width: var(--progress-hover-width);
            height: var(--progress-hover-height);
        }

        #MusicplayerButtons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 60px;
            margin-top: 30px;
        }

        #MusicplayerButtons span {
            font-size: 40px;
            font-family: webdings;
            cursor: pointer;
            padding: 20px 20px;
        }

        #MusicplayerButtons button:hover {
            background-color: #ddd;
        }

        #MusicplayerStatus>div {
            text-align: center;
            font-size: 20px;
        }
    </style>
</head>

<body>
    <audio src="music/painter.mp3" title="HITA/小曲兒 - 丹青客" controls id="myMusic"></audio>
    <hr>
    <div id="TopBlock">
        <div id="information">
            <div></div>
        </div>

        <div id="MusicplayerVolume">
            <button onclick="changeVolume(-1)">-</button>
            <input type="range" oninput="setVolumeByRangeBar()" value="50">
            <button onclick="changeVolume(1)">+</button>
            <input type="text" value="50" readonly>
        </div>
    </div>

    <div id="MusicplayerControls">
        <span onclick="changeTime(-5)">7</span>
        <span onclick="stopMusic()">&lt;</span>
        <span onclick="changeTime(+5)">8</span>
        <span onclick="setMute()">U</span>
    </div>


    <input type="range" id="ProgressBar" min="0">


    <div id="Third">
        <div id="MusicplayerButtons">
            <span onclick="changeMusic(-1)">9</span>
            <span onclick="playMusic()">4</span>
            <span onclick="changeMusic(+1)">:</span>
        </div>
    </div>

    <div id="MusicplayerStatus">
        <div>00:00：00:00</div>
        <div>｜正常｜</div>
    </div>


    <script>
        var myMusic = document.getElementById("myMusic");
        var information = document.getElementById("information");
        var MusicplayerButtons = document.getElementById("MusicplayerButtons");
        var MusicplayerControls = document.getElementById("MusicplayerControls");
        var MusicplayerVolume = document.getElementById("MusicplayerVolume");
        var MusicplayerStatus = document.getElementById("MusicplayerStatus");
        var ProgressBar = document.getElementById("ProgressBar");




        //ProgressBar
        ProgressBar.max = myMusic.duration * 10000;

        function ProgressInitial() {
            ProgressBar.max = myMusic.duration * 10000;
            setInterval(setMusicDuraion, 10);
        }




        //MusicplayerStatus
        var musicDuraion = MusicplayerStatus.children[0];
        var playStatus = MusicplayerStatus.children[1];

        function getTimeFormat(t) {
            var min = parseInt(t.toFixed(0) / 60);
            var sec = parseInt(t.toFixed(0) % 60);


            min = min < 10 ? "0" + min : min;
            sec = sec < 10 ? "0" + sec : sec;

            return min + ":" + sec;
        }

        function setMusicDuraion() {
            musicDuraion.innerHTML = getTimeFormat(myMusic.currentTime) + " / " + getTimeFormat(myMusic.duration);

            ProgressBar.value = myMusic.currentTime * 10000;
            console.log(ProgressBar.value);

            var w = myMusic.currentTime / myMusic.duration * 100;
            ProgressBar.style.backgroundImage = `linear-gradient(to right, rgb(255,179,14) ${w}%, rgb(240,240,240) ${w}%)`;
        }





        //MusicplayerVolume
        var rangeVolume = MusicplayerVolume.children[1];
        var textVolume = MusicplayerVolume.children[3];

        setVolumeByRangeBar();

        function changeVolume(v) {
            rangeVolume.value = parseInt(rangeVolume.value) + v;
            setVolumeByRangeBar();
        }

        function setVolumeByRangeBar() {
            textVolume.value = rangeVolume.value;
            myMusic.volume = textVolume.value / 100;   //真正寫入音量屬性值
            rangeVolume.style.backgroundImage = `linear-gradient(to right, rgb(255,179,14) ${rangeVolume.value}%, rgb(240,240,240) ${rangeVolume.value}%)`;
        }




        //MusicplayerControls
        function changeTime(s) {
            myMusic.currentTime += s;
        }

        function setMute() {
            myMusic.muted = !myMusic.muted;
            event.target.innerHTML = event.target.innerHTML == "U" ? "V" : "U";
            event.target.className = event.target.className == "setMute" ? "" : "setMute";
        }



        //Information
        var songInformation = information.children[0];


        //MusicplayerButtons
        function updateInfo(text) {
            songInformation.innerHTML = text;
        }

        function playMusic() {
            myMusic.play();
            event.target.innerHTML = ";";
            event.target.onclick = pauseMusic;

            ProgressInitial();
            updateInfo("正在播放： " + myMusic.title);            
        }

        function pauseMusic() {
            myMusic.pause();
            event.target.innerHTML = "4";
            event.target.onclick = playMusic;

            updateInfo("音樂暫停");
        }

        function stopMusic() {
            //音樂要停下來且時間歸零
            myMusic.pause();
            myMusic.currentTime = 0;
            event.target.previousElementSibling.innerHTML = "4";
            event.target.previousElementSibling.onclick = playMusic;

            updateInfo("音樂停止");
        }





    </script>
</body>

</html>